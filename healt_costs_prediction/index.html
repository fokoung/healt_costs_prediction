<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Insurance Cost Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for disabled button */
        .btn-disabled {
            background-color: #93c5fd; /* Lighter blue */
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen">
    <div class="w-full max-w-2xl mx-auto p-4 sm:p-6">
        <div class="bg-white shadow-xl rounded-2xl p-6 sm:p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Health Cost Predictor</h1>
                <p class="text-gray-600 mt-2">Enter your details to get an instant cost estimate.</p>
            </div>

            <form id="prediction-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Age -->
                <div class="relative">
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <label for="age" class="sr-only">Age</label>
                    <input type="number" id="age" name="age" required class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Age">
                </div>

                <!-- BMI -->
                <div class="relative">
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
                        </svg>
                    </div>
                    <label for="bmi" class="sr-only">BMI</label>
                    <input type="number" step="0.1" id="bmi" name="bmi" required class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="BMI">
                </div>

                <!-- Children -->
                <div class="relative">
                     <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                           <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z" />
                        </svg>
                    </div>
                    <label for="children" class="sr-only">Children</label>
                    <input type="number" id="children" name="children" required class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="Children">
                </div>

                <!-- Sex -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Sex</label>
                    <div class="flex gap-4">
                        <label class="flex items-center">
                            <input type="radio" name="sex" value="male" class="form-radio h-4 w-4 text-blue-600" checked>
                            <span class="ml-2 text-gray-700">Male</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="sex" value="female" class="form-radio h-4 w-4 text-blue-600">
                            <span class="ml-2 text-gray-700">Female</span>
                        </label>
                    </div>
                </div>

                <!-- Smoker -->
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Are you a smoker?</label>
                    <div class="flex gap-4">
                        <label class="flex items-center">
                            <input type="radio" name="smoker" value="yes" class="form-radio h-4 w-4 text-blue-600">
                            <span class="ml-2 text-gray-700">Yes</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="smoker" value="no" class="form-radio h-4 w-4 text-blue-600" checked>
                            <span class="ml-2 text-gray-700">No</span>
                        </label>
                    </div>
                </div>
                
                <!-- Region -->
                <div class="md:col-span-2">
                    <label for="region" class="block text-sm font-medium text-gray-700 mb-1">Region</label>
                    <select id="region" name="region" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="southwest">Southwest</option>
                        <option value="southeast">Southeast</option>
                        <option value="northwest">Northwest</option>
                        <option value="northeast">Northeast</option>
                    </select>
                </div>

                <!-- Button -->
                <div class="md:col-span-2 mt-4">
                    <button id="predict-button" type="submit" class="w-full flex justify-center items-center bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-300 transform hover:scale-105">
                        Predict Cost
                    </button>
                </div>
            </form>

            <!-- Result -->
            <div id="result-container" class="mt-8 text-center hidden">
                <div class="bg-gray-100 p-6 rounded-lg">
                    <p class="text-gray-600 text-lg">Estimated Insurance Cost:</p>
                    <p id="prediction-result" class="text-4xl sm:text-5xl font-bold text-gray-900 mt-2"></p>
                    <p id="error-message" class="text-red-500 mt-2"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('prediction-form').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const resultElement = document.getElementById('prediction-result');
            const errorElement = document.getElementById('error-message');
            const resultContainer = document.getElementById('result-container');
            const predictButton = document.getElementById('predict-button');
            
            resultElement.textContent = '';
            errorElement.textContent = '';

            // --- Collect form data ---
            const formData = new FormData(event.target);
            const data = {
                age: parseInt(formData.get('age')),
                bmi: parseFloat(formData.get('bmi')),
                children: parseInt(formData.get('children')),
                sex: formData.get('sex'),
                smoker: formData.get('smoker'),
                region: formData.get('region')
            };
            
            // --- Update button state to show loading ---
            predictButton.disabled = true;
            predictButton.classList.add('btn-disabled');
            predictButton.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Predicting...
            `;

            // --- API Call to your local Flask server ---
            fetch('http://127.0.0.1:5000/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data),
            })
            .then(response => response.ok ? response.json() : Promise.reject('Network response was not ok'))
            .then(data => {
                if (data.error) throw new Error(data.error);
                
                // Display result
                resultElement.textContent = new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0,
                }).format(data.predicted_cost);
                
                // Animate result display
                resultContainer.classList.remove('hidden');
                resultContainer.style.opacity = '0';
                resultContainer.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    resultContainer.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    resultContainer.style.opacity = '1';
                    resultContainer.style.transform = 'translateY(0)';
                }, 10);
            })
            .catch((error) => {
                console.error('Error:', error);
                errorElement.textContent = 'An error occurred. Is the local server running?';
                resultContainer.classList.remove('hidden');
            })
            .finally(() => {
                // --- Restore button state ---
                predictButton.disabled = false;
                predictButton.classList.remove('btn-disabled');
                predictButton.innerHTML = 'Predict Cost';
            });
        });
    </script>
</body>
</html>

